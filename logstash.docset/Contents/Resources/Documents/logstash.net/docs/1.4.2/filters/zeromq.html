<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="UTF-8">
  <title>logstash - open source log management</title>
  <link rel="stylesheet" href="../../..//style.css">
  </head>
  <body>
  <div class="container">
    <div class="header">
      <a href="http://logstash.net/.html"><img src="../../..//images/logo.png" alt="logstash"></a>
      <div class="nav">
        <a href="http://logstash.net/.html">home</a>
        <a href="/docs/1.4.2.html">docs</a>
        <a href="/docs/1.4.2/learn.html">about</a>
        <a href="https://github.com/elasticsearch/logstash/issues">bugs</a>
      </div>
    </div>
    <div id="content_right">
      <!--main content goes here, yo!-->
      <div class="content_wrapper">
        <img src="../../..//images/logstash.png" alt="logstash" class="mascot" style="float: right;">
         <h2>zeromq</h2>
<h3>Milestone: <a href="../plugin-milestones.html">1</a>
</h3>
<div class="community-plugin-notice">
  <strong>This is a community-contributed plugin!</strong> It does not ship with logstash by default, but it is easy to install!
  To use this, you must have <a href="../contrib-plugins.html">installed the contrib plugins package</a>.
</div>

<p>ZeroMQ filter. This is the best way to send an event externally for filtering
It works much like an exec filter would by sending the event “offsite”
for processing and waiting for a response</p>

<p>The protocol here is:
  * REQ sent with JSON-serialized logstash event
  * REP read expected to be the full JSON ‘filtered’ event
  * - if reply read is an empty string, it will cancel the event.</p>

<p>Note that this is a limited subset of the zeromq functionality in
inputs and outputs. The only topology that makes sense here is:
REQ/REP. </p>


<h3> Synopsis </h3>

This is what it might look like in your config file:

<pre><code>filter {
  zeromq {
    <a href="#add_field">add_field</a> =&gt; ... # hash (optional), default: {}
    <a href="#add_tag">add_tag</a> =&gt; ... # array (optional), default: []
    <a href="#add_tag_on_timeout">add_tag_on_timeout</a> =&gt; ... # string (optional), default: "zeromqtimeout"
    <a href="#address">address</a> =&gt; ... # string (optional), default: "tcp://127.0.0.1:2121"
    <a href="#field">field</a> =&gt; ... # string (optional)
    <a href="#mode">mode</a> =&gt; ... # string, one of ["server", "client"] (optional), default: "client"
    <a href="#remove_field">remove_field</a> =&gt; ... # array (optional), default: []
    <a href="#remove_tag">remove_tag</a> =&gt; ... # array (optional), default: []
    <a href="#retries">retries</a> =&gt; ... # number (optional), default: 3
    <a href="#sockopt">sockopt</a> =&gt; ... # hash (optional)
    <a href="#timeout">timeout</a> =&gt; ... # number (optional), default: 500
  }
}
</code></pre>

<h3> Details </h3>

<h4> 
  <a name="add_field">
    add_field
    
</a>
</h4>

<ul>
  <li> Value type is <a href="../configuration.html#hash">hash</a> </li>
  <li> Default value is {} </li>
</ul>

<p>If this filter is successful, add any arbitrary fields to this event.
Field names can be dynamic and include parts of the event using the %{field}
Example:</p>

<pre><code>filter {
  zeromq {
    add_field =&gt; { "foo_%{somefield}" =&gt; "Hello world, from %{host}" }
  }
}

# You can also add multiple fields at once:

filter {
  zeromq {
    add_field =&gt; { 
      "foo_%{somefield}" =&gt; "Hello world, from %{host}"
      "new_field" =&gt; "new_static_value"
    }
  }
}
</code></pre>

<p>If the event has field “somefield” == “hello” this filter, on success,
would add field “foo_hello” if it is present, with the
value above and the %{host} piece replaced with that value from the
event. The second example would also add a hardcoded field. </p>


<h4> 
  <a name="add_tag">
    add_tag
    
</a>
</h4>

<ul>
  <li> Value type is <a href="../configuration.html#array">array</a> </li>
  <li> Default value is [] </li>
</ul>

<p>If this filter is successful, add arbitrary tags to the event.
Tags can be dynamic and include parts of the event using the %{field}
syntax. Example:</p>

<pre><code>filter {
  zeromq {
    add_tag =&gt; [ "foo_%{somefield}" ]
  }
}

# You can also add multiple tags at once:
filter {
  zeromq {
    add_tag =&gt; [ "foo_%{somefield}", "taggedy_tag"]
  }
}
</code></pre>

<p>If the event has field “somefield” == “hello” this filter, on success,
would add a tag “foo_hello” (and the second example would of course add a “taggedy_tag” tag).</p>


<h4> 
  <a name="add_tag_on_timeout">
    add_tag_on_timeout
    
</a>
</h4>

<ul>
  <li> Value type is <a href="../configuration.html#string">string</a> </li>
  <li> Default value is "zeromqtimeout" </li>
</ul>

<p>tag to add if zeromq timeout expires before getting back an answer.
If set to “” then no tag will be added.</p>


<h4> 
  <a name="address">
    address
    
</a>
</h4>

<ul>
  <li> Value type is <a href="../configuration.html#string">string</a> </li>
  <li> Default value is "tcp://127.0.0.1:2121" </li>
</ul>

<p>0mq socket address to connect or bind
Please note that inproc:// will not work with logstash
as we use a context per thread
By default, filters connect</p>


<h4> 
  <a name="exclude_tags">
    exclude_tags
     <strong>DEPRECATED</strong>
</a>
</h4>

<ul>
  <li> DEPRECATED WARNING: This config item is deprecated. It may be removed in a further version. </li>
  <li> Value type is <a href="../configuration.html#array">array</a> </li>
  <li> Default value is [] </li>
</ul>

<p>Only handle events without all/any (controlled by exclude_any config
option) of these tags.
Optional.</p>


<h4> 
  <a name="field">
    field
    
</a>
</h4>

<ul>
  <li> Value type is <a href="../configuration.html#string">string</a> </li>
  <li> There is no default value for this setting. </li>
</ul>

<p>The field to send off-site for processing
If this is unset, the whole event will be sent
TODO (lusis)
Allow filtering multiple fields</p>


<h4> 
  <a name="mode">
    mode
    
</a>
</h4>

<ul>
  <li> Value can be any of: "server", "client" </li>
  <li> Default value is "client" </li>
</ul>

<p>0mq mode
server mode binds/listens
client mode connects</p>


<h4> 
  <a name="remove_field">
    remove_field
    
</a>
</h4>

<ul>
  <li> Value type is <a href="../configuration.html#array">array</a> </li>
  <li> Default value is [] </li>
</ul>

<p>If this filter is successful, remove arbitrary fields from this event.
Fields names can be dynamic and include parts of the event using the %{field}
Example:</p>

<pre><code>filter {
  zeromq {
    remove_field =&gt; [ "foo_%{somefield}" ]
  }
}

# You can also remove multiple fields at once:

filter {
  zeromq {
    remove_field =&gt; [ "foo_%{somefield}" "my_extraneous_field" ]
  }
}
</code></pre>

<p>If the event has field “somefield” == “hello” this filter, on success,
would remove the field with name “foo_hello” if it is present. The second 
example would remove an additional, non-dynamic field.</p>


<h4> 
  <a name="remove_tag">
    remove_tag
    
</a>
</h4>

<ul>
  <li> Value type is <a href="../configuration.html#array">array</a> </li>
  <li> Default value is [] </li>
</ul>

<p>If this filter is successful, remove arbitrary tags from the event.
Tags can be dynamic and include parts of the event using the %{field}
syntax. Example:</p>

<pre><code>filter {
  zeromq {
    remove_tag =&gt; [ "foo_%{somefield}" ]
  }
}

# You can also remove multiple tags at once:

filter {
  zeromq {
    remove_tag =&gt; [ "foo_%{somefield}", "sad_unwanted_tag"]
  }
}
</code></pre>

<p>If the event has field “somefield” == “hello” this filter, on success,
would remove the tag “foo_hello” if it is present. The second example
would remove a sad, unwanted tag as well. </p>


<h4> 
  <a name="retries">
    retries
    
</a>
</h4>

<ul>
  <li> Value type is <a href="../configuration.html#number">number</a> </li>
  <li> Default value is 3 </li>
</ul>

<p>number of retries, used for both sending and receiving messages.
for sending, retries should return instantly.
for receiving, the total blocking time is up to retries X timeout, 
which by default is 3 X 500 = 1500ms</p>


<h4> 
  <a name="sockopt">
    sockopt
    
</a>
</h4>

<ul>
  <li> Value type is <a href="../configuration.html#hash">hash</a> </li>
  <li> There is no default value for this setting. </li>
</ul>

<p>0mq socket options
This exposes zmq_setsockopt
for advanced tuning
see http://api.zeromq.org/2-1:zmq-setsockopt for details</p>

<p>This is where you would set values like:
ZMQ::HWM - high water mark
ZMQ::IDENTITY - named queues
ZMQ::SWAP_SIZE - space for disk overflow
ZMQ::SUBSCRIBE - topic filters for pubsub</p>

<p>example: sockopt =&gt; [“ZMQ::HWM”, 50, “ZMQ::IDENTITY”, “my_named_queue”]</p>


<h4> 
  <a name="tags">
    tags
     <strong>DEPRECATED</strong>
</a>
</h4>

<ul>
  <li> DEPRECATED WARNING: This config item is deprecated. It may be removed in a further version. </li>
  <li> Value type is <a href="../configuration.html#array">array</a> </li>
  <li> Default value is [] </li>
</ul>

<p>Only handle events with all/any (controlled by include_any config option) of these tags.
Optional.</p>


<h4> 
  <a name="timeout">
    timeout
    
</a>
</h4>

<ul>
  <li> Value type is <a href="../configuration.html#number">number</a> </li>
  <li> Default value is 500 </li>
</ul>

<p>timeout in milliseconds on which to wait for a reply.</p>


<h4> 
  <a name="type">
    type
     <strong>DEPRECATED</strong>
</a>
</h4>

<ul>
  <li> DEPRECATED WARNING: This config item is deprecated. It may be removed in a further version. </li>
  <li> Value type is <a href="../configuration.html#string">string</a> </li>
  <li> Default value is "" </li>
</ul>

<p>Note that all of the specified routing options (type,tags.exclude_tags,include_fields,exclude_fields)
must be met in order for the event to be handled by the filter.
The type to act on. If a type is given, then this filter will only
act on messages with the same type. See any input plugin’s “type”
attribute for more.
Optional.</p>



<hr>

This is documentation from <a href="https://github.com/logstash/logstash/blob/v1.4.2/lib/logstash/filters/zeromq.rb">lib/logstash/filters/zeromq.rb</a>

      </div>
      <div class="clear">
      </div>
    </div>
  </div>
  <!--closes main container div-->
  <div class="clear">
  </div>
  <div class="footer">
    <p>
      Hello! I'm your friendly footer. If you're actually reading this, I'm impressed.
    </p>
  </div>
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-6522917-5']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script type="text/javascript">
/* <![CDATA[ */
  var google_conversion_id = 985891458;
  var google_custom_params = window.google_tag_params;
  var google_remarketing_only = true;
  /* ]]> */
  </script>
  <script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">
  </script>
  <noscript>
    <div style="display:inline;">
      <img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/985891458/?value=0&amp;guid=ON&amp;script=0">
    </div>
  </noscript>
  <script src="/js/patch.js?1.4.2"></script>
  </body>
</html>
